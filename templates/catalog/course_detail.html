{% extends "base_generic.html" %}

{% block content %}

{% if exists %}
	<h1> {{ subject_code }} {{ catalog_code }}</h1>
	<h3><a href="{{course.subject.getAbsoluteUrl}}">{{ course.subject.name }}</a> - {{ course.name }}</h3>
	{% if term_list %}
		<div>
		<input type="checkbox" id="showOfferedCheck" onclick="updateShowOffered()"> 
		<label for="showOfferedCheck">Show only terms where {{ subject_code }} {{ catalog_code }} was offered<br/><br/></label></div>

		<table id="termTable">
			<tr>
				<th>Term</th>
				<th></th>
				<th>Status</th>
				<th>Enrollment</th>
				<th>Max</th>
				<th>Instructors</th>
			</tr>	
				
			{% for term, info in term_list.items %}
				{% if info %}
				<tr>
					<td>{{term}}</td>
					<td>{{term.reverseName}}</td>
					<td>{{info.status}}</td>
					<td></td>
					<td></td>
					<td>
						{% if info.instructors %}
						<input type="checkbox" class="toggle_box" id="{{term}}_toggle_box"/>
						<label for="{{term}}_toggle_box">
							+
							<div>
							{% for inst in info.instructors %}
							<br/><a href="{{ inst.getAbsoluteUrl }}">{{ inst }}</a>
							{% endfor %}
							</div>
						</label>
						{% else %}
						Unknown
						{% endif %}
					</td>

					
				</tr>
				{% else %}
				<tr style="color:grey;" class="offeredUnknown">
					<td>{{ term.code }}</td>
					<td>{{ term.reverseName }}</td>
					<td>Unknown</td>
					<td></td>
				</tr>
				
				{% endif %}
			{% endfor %}
			
			
			{% comment %}
			{% for offering in offering_list %}
				<tr><td>{{ offering.term.name }}</td></tr>
			{% endfor %}
			
			{% endcomment %}
		</table>
		
		<script>
			function updateShowOffered() {
				console.log("clicked!")
				showOfferedCheck = document.getElementById("showOfferedCheck")
				onlyShowOffered = showOfferedCheck.checked
				
				table = document.getElementById("termTable")
				
				for (var i = 0, row; row = table.rows[i]; i++) {

					if (row.className == "offeredUnknown") {

						if (onlyShowOffered == true) {
							console.log("Filtering row, offeredUnkonwn = true, hiding row")

							row.style.display = "none"
						} else {
							console.log("Filtering row, offeredUnkonwn = true, showing row")
							row.style.display = ""
						}
					} else {
						console.log("Filtering row, offeredUnkonwn = false")

					
					}
				}
				
				
			}
			
			document.getElementById("showOfferedCheck").checked = true
			updateShowOffered()
		</script>

	{% else %}
		There is no record of this course being offered.
	{% endif %}
{% else %}
	Course with code '{{ subject_code }} {{ catalog_code }}' not found.
{% endif %}
{% endblock %}